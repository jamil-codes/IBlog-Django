{% extends 'blog/layout.html' %}

{% block title %}
  {{ category.title }} - Posts
{% endblock %}

{% block body %}
  <section class="text-gray-600 body-font">
    <div class="container px-5 pt-10 pb-16 mx-auto">
      <h2 class="text-3xl sm:text-4xl font-medium text-center text-gray-900 mb-12">{{ category.title }}</h2>
      <p class="text-center text-gray-600 mb-10">{{ category.description }}</p>

      <div class="flex flex-wrap -m-4">
        {% for post in posts %}
          <div class="p-4 md:w-1/3">
            <div class="h-full border-2 border-gray-200 border-opacity-60 rounded-lg overflow-hidden">
              <img class="lg:h-48 md:h-36 w-full object-cover object-center" src="{{ post.image.url }}" alt="{{ post.title }}" />
              <div class="p-6">
                <h3 class="title-font text-lg font-medium text-gray-900 mb-3">{{ post.title }}</h3>
                <p class="leading-relaxed text-sm mb-3">{{ post.content|striptags|truncatechars:120 }}</p>
                <div class="flex items-center flex-wrap">
                  <a href="{% url 'blog:post_detail' post.pk %}" class="text-blue-500 inline-flex items-center md:mb-2 lg:mb-0">
                    Learn More<svg class="w-4 h-4 ml-2" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M5 12h14"></path>
                      <path d="M12 5l7 7-7 7"></path>
                    </svg>
                  </a>
                </div>
              </div>
            </div>
          </div>
        {% empty %}
          <div class="text-center text-gray-500 w-full py-8">No posts available in this category.</div>
        {% endfor %}
      </div>

      <!-- Pagination -->
      <div class="mt-12 flex justify-center">
        <nav class="inline-flex -space-x-px text-sm">
          {% if posts.has_previous %}
            <a href="?page={{ posts.previous_page_number }}" class="px-3 py-2 ml-0 leading-tight text-gray-500 bg-white border border-gray-300 rounded-l hover:bg-gray-100 hover:text-gray-700">Previous</a>
          {% else %}
            <span class="px-3 py-2 ml-0 leading-tight text-gray-400 bg-gray-100 border border-gray-300 rounded-l cursor-not-allowed">Previous</span>
          {% endif %}

          {% for num in posts.paginator.page_range %}
            {% if num == posts.number %}
              <span class="px-3 py-2 leading-tight text-white bg-blue-500 border border-blue-300">{{ num }}</span>
            {% elif num > posts.number|add:'-3' and num < posts.number|add:'3' %}
              <a href="?page={{ num }}" class="px-3 py-2 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700">{{ num }}</a>
            {% endif %}
          {% endfor %}

          {% if posts.has_next %}
            <a href="?page={{ posts.next_page_number }}" class="px-3 py-2 leading-tight text-gray-500 bg-white border border-gray-300 rounded-r hover:bg-gray-100 hover:text-gray-700">Next</a>
          {% else %}
            <span class="px-3 py-2 leading-tight text-gray-400 bg-gray-100 border border-gray-300 rounded-r cursor-not-allowed">Next</span>
          {% endif %}
        </nav>
      </div>
    </div>
  </section>
{% endblock %}
